{
  "commit_sha": "8fc98918bb5e2a3b34e115124533397ea1c4640f",
  "timestamp": "2025-11-22T16:58:41.489960",
  "stats": {
    "total": 3,
    "added": 0,
    "removed": 1,
    "persisted": 3
  },
  "diff": {
    "added": [],
    "removed": [
      "39f5ab20bc7e7c2a1b54d7ebc84681e489c35001b1583a0d047cad853c973f9495d76e1f93c105373ab0ec180554d83892e17e1b6f28feee252a467ef2b8753e_0"
    ],
    "persisted": [
      "b6bf3c662cbf23e107516b7d13f9761a6497dc458d9fca8fce476ab92b609f7abbf39adf2c0bdf2ad91859cd82951900015aacbe254deb0027c2f024d583e0aa_0",
      "be98f7eedc9f1cd59e8b1b375215267f67840dfbf2d4b1a34169cadf496d89da3eb1f498a87a8631a170930cb1d00cae30a085cdf4b7036aad89072ec0b62bfe_0",
      "6ab7b69a2b0307fdee98ba82e45bebbf88572294fb8cc6506ead61d85c0761a646da0c5349b05b5eec3b21c43a93c34dad581a60898d4368ab6060f045017cc5_0"
    ]
  },
  "vulns": {
    "b6bf3c662cbf23e107516b7d13f9761a6497dc458d9fca8fce476ab92b609f7abbf39adf2c0bdf2ad91859cd82951900015aacbe254deb0027c2f024d583e0aa_0": {
      "uid": "b6bf3c662cbf23e107516b7d13f9761a6497dc458d9fca8fce476ab92b609f7abbf39adf2c0bdf2ad91859cd82951900015aacbe254deb0027c2f024d583e0aa_0",
      "rule_id": "python.lang.security.audit.dynamic-urllib-use-detected.dynamic-urllib-use-detected",
      "file": "/tmp/mcp_semgrep_q4nlw4r1/repo/@obsoletesoftware-composition-analysis/python/python-example/main.py",
      "code": "    with urllib.request.urlopen(NVD_CPE_XML_DOWNLOAD_URL, context=context) as response, open(zip_path, 'wb') as out_file:",
      "severity": "WARNING",
      "message": "Detected a dynamic value being used with urllib. urllib supports 'file://' schemes, so a dynamic value controlled by a malicious actor may allow them to read arbitrary files. Audit uses of urllib calls to ensure user data cannot control the URLs, or consider using the 'requests' library instead.",
      "semgrep_fingerprint": "b6bf3c662cbf23e107516b7d13f9761a6497dc458d9fca8fce476ab92b609f7abbf39adf2c0bdf2ad91859cd82951900015aacbe254deb0027c2f024d583e0aa_0",
      "asvs": {
        "control_id": "5.2.4 Dynamic Code Execution Features",
        "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v52-sanitization-and-sandboxing-requirements",
        "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
        "version": "4"
      },
      "owasp": "A01:2017 - Injection",
      "references": [
        "https://cwe.mitre.org/data/definitions/939.html"
      ]
    },
    "6ab7b69a2b0307fdee98ba82e45bebbf88572294fb8cc6506ead61d85c0761a646da0c5349b05b5eec3b21c43a93c34dad581a60898d4368ab6060f045017cc5_0": {
      "uid": "6ab7b69a2b0307fdee98ba82e45bebbf88572294fb8cc6506ead61d85c0761a646da0c5349b05b5eec3b21c43a93c34dad581a60898d4368ab6060f045017cc5_0",
      "rule_id": "python.lang.security.audit.eval-detected.eval-detected",
      "file": "/tmp/mcp_semgrep_q4nlw4r1/repo/sast/python/project/badpython.py",
      "code": "eval(user_input)",
      "severity": "WARNING",
      "message": "Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources.",
      "semgrep_fingerprint": "6ab7b69a2b0307fdee98ba82e45bebbf88572294fb8cc6506ead61d85c0761a646da0c5349b05b5eec3b21c43a93c34dad581a60898d4368ab6060f045017cc5_0",
      "asvs": {
        "control_id": "5.2.4 Dyanmic Code Execution Features",
        "control_url": "https://github.com/OWASP/ASVS/blob/master/4.0/en/0x13-V5-Validation-Sanitization-Encoding.md#v52-sanitization-and-sandboxing-requirements",
        "section": "V5: Validation, Sanitization and Encoding Verification Requirements",
        "version": "4"
      },
      "owasp": [
        "A03:2021 - Injection"
      ],
      "references": [
        "https://owasp.org/Top10/A03_2021-Injection"
      ]
    },
    "be98f7eedc9f1cd59e8b1b375215267f67840dfbf2d4b1a34169cadf496d89da3eb1f498a87a8631a170930cb1d00cae30a085cdf4b7036aad89072ec0b62bfe_0": {
      "uid": "be98f7eedc9f1cd59e8b1b375215267f67840dfbf2d4b1a34169cadf496d89da3eb1f498a87a8631a170930cb1d00cae30a085cdf4b7036aad89072ec0b62bfe_0",
      "rule_id": "python.lang.security.audit.md5-used-as-password.md5-used-as-password",
      "file": "/tmp/mcp_semgrep_q4nlw4r1/repo/sast/python/project/badpython.py",
      "code": "password_hash = hashlib.md5(\"mypassword\".encode()).hexdigest()()",
      "severity": "WARNING",
      "message": "It looks like MD5 is used as a password hash. MD5 is not considered a secure password hash because it can be cracked by an attacker in a short amount of time. Use a suitable password hashing function such as scrypt. You can use `hashlib.scrypt`.",
      "semgrep_fingerprint": "be98f7eedc9f1cd59e8b1b375215267f67840dfbf2d4b1a34169cadf496d89da3eb1f498a87a8631a170930cb1d00cae30a085cdf4b7036aad89072ec0b62bfe_0",
      "asvs": null,
      "owasp": [
        "A03:2017 - Sensitive Data Exposure",
        "A02:2021 - Cryptographic Failures"
      ],
      "references": [
        "https://tools.ietf.org/html/rfc6151",
        "https://crypto.stackexchange.com/questions/44151/how-does-the-flame-malware-take-advantage-of-md5-collision",
        "https://pycryptodome.readthedocs.io/en/latest/src/hash/sha3_256.html",
        "https://security.stackexchange.com/questions/211/how-to-securely-hash-passwords",
        "https://github.com/returntocorp/semgrep-rules/issues/1609",
        "https://docs.python.org/3/library/hashlib.html#hashlib.scrypt"
      ]
    }
  },
  "topics": {
    "b6bf3c662cbf23e107516b7d13f9761a6497dc458d9fca8fce476ab92b609f7abbf39adf2c0bdf2ad91859cd82951900015aacbe254deb0027c2f024d583e0aa_0": "misc",
    "6ab7b69a2b0307fdee98ba82e45bebbf88572294fb8cc6506ead61d85c0761a646da0c5349b05b5eec3b21c43a93c34dad581a60898d4368ab6060f045017cc5_0": "misc",
    "be98f7eedc9f1cd59e8b1b375215267f67840dfbf2d4b1a34169cadf496d89da3eb1f498a87a8631a170930cb1d00cae30a085cdf4b7036aad89072ec0b62bfe_0": "misc"
  },
  "topic_drift": {
    "jaccard": 0.0,
    "kl_divergence": 0.0
  },
  "time_to_fix_store": {
    "b6bf3c662cbf23e107516b7d13f9761a6497dc458d9fca8fce476ab92b609f7abbf39adf2c0bdf2ad91859cd82951900015aacbe254deb0027c2f024d583e0aa_0": {
      "first_seen_sha": "bfc1f04e2642cf286b8a50f8a755f58202bf30d8",
      "first_seen_at": "2025-11-22T16:53:26.268892",
      "last_seen_sha": "8fc98918bb5e2a3b34e115124533397ea1c4640f",
      "resolved_sha": null,
      "resolved_at": null
    },
    "be98f7eedc9f1cd59e8b1b375215267f67840dfbf2d4b1a34169cadf496d89da3eb1f498a87a8631a170930cb1d00cae30a085cdf4b7036aad89072ec0b62bfe_0": {
      "first_seen_sha": "bfc1f04e2642cf286b8a50f8a755f58202bf30d8",
      "first_seen_at": "2025-11-22T16:53:26.268892",
      "last_seen_sha": "8fc98918bb5e2a3b34e115124533397ea1c4640f",
      "resolved_sha": null,
      "resolved_at": null
    },
    "6ab7b69a2b0307fdee98ba82e45bebbf88572294fb8cc6506ead61d85c0761a646da0c5349b05b5eec3b21c43a93c34dad581a60898d4368ab6060f045017cc5_0": {
      "first_seen_sha": "bfc1f04e2642cf286b8a50f8a755f58202bf30d8",
      "first_seen_at": "2025-11-22T16:53:26.268892",
      "last_seen_sha": "8fc98918bb5e2a3b34e115124533397ea1c4640f",
      "resolved_sha": null,
      "resolved_at": null
    },
    "39f5ab20bc7e7c2a1b54d7ebc84681e489c35001b1583a0d047cad853c973f9495d76e1f93c105373ab0ec180554d83892e17e1b6f28feee252a467ef2b8753e_0": {
      "first_seen_sha": "bfc1f04e2642cf286b8a50f8a755f58202bf30d8",
      "first_seen_at": "2025-11-22T16:53:26.268892",
      "last_seen_sha": "863473b0205d166ca8d3c3178cdec8f1a8d4919c",
      "resolved_sha": "8fc98918bb5e2a3b34e115124533397ea1c4640f",
      "resolved_at": "2025-11-22T16:58:41.489960"
    }
  },
  "enrichment": {
    "type": "repo",
    "repo": "victorstrandmoe97/python-example-projects",
    "flag_status": "flagged",
    "after": {
      "total_findings": 3,
      "rule_counts": {
        "python.lang.security.audit.dynamic-urllib-use-detected.dynamic-urllib-use-detected": 1,
        "python.lang.security.audit.eval-detected.eval-detected": 1,
        "python.lang.security.audit.md5-used-as-password.md5-used-as-password": 1
      },
      "owasp_counts": {
        "A": 1,
        "0": 2,
        "1": 2,
        ":": 1,
        "2": 1,
        "7": 1,
        " ": 2,
        "-": 1,
        "I": 1,
        "n": 2,
        "j": 1,
        "e": 1,
        "c": 1,
        "t": 1,
        "i": 1,
        "o": 1,
        "A03:2021 - Injection": 1,
        "A03:2017 - Sensitive Data Exposure": 1,
        "A02:2021 - Cryptographic Failures": 1
      },
      "severity_counts": {
        "WARNING": 3
      },
      "owasp_tags": [
        "a02-2021",
        "a03-2017",
        "a03-2021"
      ]
    },
    "semantic": {
      "owasp_tags": [
        "a02-2021",
        "a03-2017",
        "a03-2021"
      ]
    },
    "rule_explanations": {
      "python.lang.security.audit.dynamic-urllib-use-detected.dynamic-urllib-use-detected": "Detected a dynamic value being used with urllib. urllib supports 'file://' schemes, so a dynamic value controlled by a malicious actor may allow them to read arbitrary files. Audit uses of urllib calls to ensure user data cannot control the URLs, or consider using the 'requests' library instead. This relates to A. Observed severity: WARNING in 1 finding(s).",
      "python.lang.security.audit.eval-detected.eval-detected": "Detected the use of eval(). eval() can be dangerous if used to evaluate dynamic content. If this content can be input from outside the program, this may be a code injection vulnerability. Ensure evaluated content is not definable by external sources. This relates to A03:2021 - Injection. Observed severity: WARNING in 1 finding(s).",
      "python.lang.security.audit.md5-used-as-password.md5-used-as-password": "It looks like MD5 is used as a password hash. MD5 is not considered a secure password hash because it can be cracked by an attacker in a short amount of time. Use a suitable password hashing function such as scrypt. You can use `hashlib.scrypt`. This relates to A03:2017 - Sensitive Data Exposure. Observed severity: WARNING in 1 finding(s)."
    },
    "before": {
      "total_findings": 4,
      "rule_counts": {
        "python.lang.security.audit.dynamic-urllib-use-detected.dynamic-urllib-use-detected": 2,
        "python.lang.security.audit.eval-detected.eval-detected": 1,
        "python.lang.security.audit.md5-used-as-password.md5-used-as-password": 1
      },
      "owasp_counts": {
        "A": 2,
        "0": 4,
        "1": 4,
        ":": 2,
        "2": 2,
        "7": 2,
        " ": 4,
        "-": 2,
        "I": 2,
        "n": 4,
        "j": 2,
        "e": 2,
        "c": 2,
        "t": 2,
        "i": 2,
        "o": 2,
        "A03:2021 - Injection": 1,
        "A03:2017 - Sensitive Data Exposure": 1,
        "A02:2021 - Cryptographic Failures": 1
      },
      "severity_counts": {
        "WARNING": 4
      },
      "owasp_tags": [
        "a02-2021",
        "a03-2017",
        "a03-2021"
      ]
    },
    "diff": {
      "total_delta": -1,
      "rule_delta": {
        "python.lang.security.audit.dynamic-urllib-use-detected.dynamic-urllib-use-detected": -1,
        "python.lang.security.audit.eval-detected.eval-detected": 0,
        "python.lang.security.audit.md5-used-as-password.md5-used-as-password": 0
      },
      "owasp_delta": {
        " ": -2,
        "-": -1,
        "0": -2,
        "1": -2,
        "2": -1,
        "7": -1,
        ":": -1,
        "A": -1,
        "A02:2021 - Cryptographic Failures": 0,
        "A03:2017 - Sensitive Data Exposure": 0,
        "A03:2021 - Injection": 0,
        "I": -1,
        "c": -1,
        "e": -1,
        "i": -1,
        "j": -1,
        "n": -2,
        "o": -1,
        "t": -1
      }
    }
  }
}