rules:
  - id: env-production-secrets
    patterns:
      - pattern: $KEY=$VALUE
        pattern-regex: '.+='
    message: >
      This production environment file contains a filled value for a key.
      Make sure it does not contain secrets (like API keys, passwords, or tokens)
      committed to source control.
    severity: WARNING
    languages:
      - dotenv
    metadata:
      category: security
      subcategory:
        - secret
      cwe:
        - "CWE-522: Insufficiently Protected Credentials"
      owasp:
        - "A06:2021 - Security Misconfiguration"
      references:
        - "https://owasp.org/Top10/A06_2021-Security_Misconfiguration/"
    files:
      - ".env.production*"
      - "production.env*"
      - "*.env.*production*"
