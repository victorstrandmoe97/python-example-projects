rules:
- id: detect-bracket-object-injection
  message: |
    Object injection via bracket notation via $FIELD
  severity: WARNING
  languages:
    - javascript
    - typescript
  metadata:
    likelihood: HIGH
    impact: HIGH
    confidence: MEDIUM
    category: security
    cwe:
      - "CWE-20: Improper Input Validation"
    owasp:
      - "A03:2021 - Injection"
    references:
      - https://cwe.mitre.org/data/definitions/20.html
      - https://owasp.org/Top10/A03_2021-Injection
  patterns:
    - pattern: const $VAR = $OBJ[$FIELD]
    - pattern-not: const $VAR = $OBJ["..."]
    - pattern-not: const $FIELD = ...
