rules:
- id: react-props-injection
  message: |
    Injecting arbitrary props into a new element may introduce XSS vulnerabilities.
  metadata:
    cwe: 
      - "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
    owasp: "A07:2021 - Cross-Site Scripting (XSS)"
    references:
      - https://medium.com/dailyjs/exploiting-script-injection-flaws-in-reactjs-883fb1fe36c1
    category: security
    technology:
      - react
  severity: WARNING
  languages:
    - typescript
    - javascript
  patterns:
    - pattern-inside: |
        import $PROPS from "...";
        ...
    - pattern-inside: |
        $PROPS = $METHOD(...);
        ...
    - pattern-inside: |
        function $FUNC(...,$PROPS,...) { ... }
    - pattern-either:
      - pattern: <$EL {...<... $PROPS ...>} />
      - pattern: <$EL {...$F(<... $PROPS ...>)} />
      - pattern: React.createElement($EL, <... $PROPS ...>)
      - pattern: React.createElement($EL, $F(<... $PROPS ...>))
    - pattern-not: <$EL {...{...}} />
    - pattern-not: React.createElement($EL, {...})
