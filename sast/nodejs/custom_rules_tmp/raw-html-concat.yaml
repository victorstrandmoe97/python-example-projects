rules:
- id: raw-html-concat
  message: >
    User controlled data in a HTML string may result in XSS
  metadata:
    cwe: 
      - "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
    owasp: 'A03:2021 Injection'
    references:
      - https://owasp.org/www-community/attacks/xss/
    category: security
    technology:
      - browser
  severity: WARNING
  languages:
    - javascript
    - typescript
  patterns:
    - pattern-either:
        - pattern: '"..." + $X'
        - pattern: '$X + "..."'
        - pattern: '"...".concat(..., $X, ...)'
        - pattern: '$X.concat(..., "...", ...)'
        - pattern: '["...", $X, ...].join(...)'
        - pattern: '[..., $X, "..."].join(...)'
        - pattern: '`...${$X}...`'
    - pattern-inside: |
        function $FUNC(..., $X, ...) {
          ...
        }
    - pattern-not: |
        $X + ""
    - pattern-not: |
        "" + $X
    - pattern-not: |
        $X = $X + "..."
    - pattern-not: |
        $X = "..." + $X
