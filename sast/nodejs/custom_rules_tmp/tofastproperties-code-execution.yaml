rules:
- id: tofastproperties-code-execution
  message: |
    Potential arbitrary code execution, whatever is provided to `toFastProperties` is sent straight to eval()
  metadata:
    cwe: 
      - "CWE-94: Improper Control of Generation of Code ('Code Injection')"
    owasp: 'A03:2021 Injection'
    category: security
    technology:
      - bluebird
  severity: WARNING
  languages:
    - javascript
    - typescript
  patterns:
    - pattern: "$UTIL.toFastProperties(...)"
    - pattern: "toFastProperties(...)"
    - pattern-not: '$UTIL.toFastProperties("...", ...)'
    - pattern-not: 'toFastProperties("...", ...)'
    - pattern-inside: |
        $BB = require('bluebird');
        ...
    - pattern-inside: |
        import 'bluebird';
        ...
