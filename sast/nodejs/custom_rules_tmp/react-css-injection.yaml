rules:
- id: react-css-injection
  message: |
    User-controlled data in a `style` attribute is an anti-pattern and can lead to XSS
  metadata:
    cwe: 
      - "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
    owasp: 'A03:2021 Injection'
    category: security
    technology:
      - react
  severity: WARNING
  languages:
    - typescript
    - javascript
  patterns:
    - pattern-inside: |
        import $STYLE from "...";
        ...
    - pattern-inside: |
        $STYLE = $METHOD(...);
        ...
    - pattern-inside: |
        function $FUNC(..., {$STYLE}, ...) { ... }
    - pattern-inside: |
        function $FUNC(..., $STYLE, ...) { ... }
    - pattern-either:
        - pattern: "<$EL style={$STYLE} />"
        - pattern: "$R.createElement($EL, {style: $STYLE}, ...)"
    - pattern-not: "<$EL style={{...}} />"
    - pattern-not: "$R.createElement($EL, {style: {...}}, ...)"
