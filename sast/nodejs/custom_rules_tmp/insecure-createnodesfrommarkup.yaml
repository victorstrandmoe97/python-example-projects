rules:
- id: insecure-createnodesfrommarkup
  message: |
    User controlled data in a `createNodesFromMarkup` call is an anti-pattern
    that can lead to XSS vulnerabilities.
  metadata:
    cwe: 
      - "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
    owasp: 'A02:2021 Cryptographic Failures'
    category: security
    technology:
      - fbjs
  severity: WARNING
  languages:
    - javascript
    - typescript
  patterns:
    - pattern-either:
        - pattern: createNodesFromMarkup($DATA)
        - pattern: $X.createNodesFromMarkup($DATA)
    - pattern-not: 'createNodesFromMarkup("...", ...)'
    - pattern-not: '$X.createNodesFromMarkup("...", ...)'
