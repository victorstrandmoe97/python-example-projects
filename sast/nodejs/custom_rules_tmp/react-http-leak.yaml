rules:
- id: react-http-leak
  message: >-
    This HTML element '$EL' and attribute '$ATTR' together may load an external
    resource. This means that if dynamic content can enter this attribute it may
    be possible for an attacker to send HTTP requests to unintended locations which
    may leak data about your users. If this element is reaching out to a known host,
    consider hardcoding the host (or loading from a configuration) and appending the
    dynamic path. See https://github.com/cure53/HTTPLeaks for more information.
  metadata:
    owasp: 'A01:2021 Broken Access Control'
    cwe:
      - 'CWE-200: Exposure of Sensitive Information to an Unauthorized Actor'
    references:
      - https://github.com/cure53/HTTPLeaks
    category: security
    technology:
      - react
  languages:
    - typescript
    - javascript
  severity: WARNING
  patterns:
    - pattern: <$EL codebase=... />
    - pattern: <$EL cite=... />
    - pattern: <$EL longdesc=... />
    - pattern: <$EL src={$INJECT} />
    - pattern: <$EL usemap=... />
    - pattern: <$EL formaction=... />
    - pattern: <$EL srcset=... />
    - pattern: <$EL archive=... />
    - pattern: <body background=... />
    - pattern: <form action=... />
    - pattern: <head profile=... />
    - pattern: <object $ATTR=... />
    - pattern: <video poster=... />
    - pattern: <command icon=... />
    - pattern: <html manifest=... />
    - pattern: <meta content=... />
    - pattern-not: <$EL codebase="..." />
    - pattern-not: <$EL cite="..." />
    - pattern-not: <$EL longdesc="..." />
    - pattern-not: <$EL src="..." />
    - pattern-not: <$EL usemap="..." />
    - pattern-not: <$EL formaction="..." />
    - pattern-not: <$EL srcset="..." />
    - pattern-not: <$EL archive="..." />
    - pattern-not: <body background="..." />
    - pattern-not: <form action="..." />
    - pattern-not: <head profile="..." />
    - pattern-not: <object $ATTR="..." />
    - pattern-not: <video poster="..." />
    - pattern-not: <command icon="..." />
    - pattern-not: <html manifest="..." />
    - pattern-not: <meta content="..." />
